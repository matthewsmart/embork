#!/usr/bin/env ruby

require 'embork'
require 'thor'

class EmborkCLI < Thor
  class_option :environment, :type => :string, :default => :develpment,
    :desc => "The target environment."
  class_option :borkfile, :type => :string, :default => "./Borkfile",
    :desc => "Path to the embork config file."

  desc "create PACKAGE_NAME", %{generate an Embork Ember application called "PACKAGE_NAME"}
  option :use_ember_data, :type => :boolean, :default => false
  option :directory, :type => :string, :default => nil
  def create(package_name)
    puts %{Creating embork app in "%s"} % package_name
    Embork::Generator.new(package_name, options).generate
  end

  desc "server [ENVIRONMENT]", %{run the development or production server}
  option :port, :type => :numeric, :default => 9292
  option :host, :type => :string, :default => 'localhost'
  option :bundle_version, :type => :string, :default => nil
  option :with_latest_bundle, :type => :boolean, :default => false
  def server(environment = :development)
    borkfile = Embork::Borkfile.new options[:borkfile]
    Embork::Server.new(borkfile, options).run
  end
end

EmborkCLI.start(ARGV)
